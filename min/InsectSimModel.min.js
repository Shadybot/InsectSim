(function(){var t,e,i,n,o,r,s,u,h,a,l,p,c,d,T,f={}.hasOwnProperty,A=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},y=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};T=this,T.ATTR={POWER:"P",STAMINA:"ST",SPEED:"SP",FIRE:"F",WATER:"W",THUNDER:"T",ICE:"I",DRAGON:"D"},T.LEVEL_LIMIT_LIST=[15,30,45,54,63,72,81,90],h=function(){function t(){this.listeners=[],this.type=""}return t.prototype.addListener=function(t){return this.listeners.push(t),this.notifyInitialize(this)},t.prototype.notifyUpdate=function(){var t,e,i,n,o;for(n=this.listeners,o=[],e=0,i=n.length;i>e;e++)t=n[e],o.push(t.onUpdate(this));return o},t.prototype.notifyInitialize=function(){var t,e,i,n,o;for(n=this.listeners,o=[],e=0,i=n.length;i>e;e++)t=n[e],o.push(t.onInitialize(this));return o},t}(),a=function(){function t(){}return t.prototype.onUpdate=function(){},t.prototype.onInitialize=function(){},t}(),T.AttributeStatus=function(t){function e(t,i,n,o,r){this.name=t,this.attribute=i,this.initStatus=n,this.requirePointMax=o,this.growthUnit=r,e.__super__.constructor.call(this),this.type="Status",this.name=this.name,this.status=this.initStatus,this.growthPoint=0,this.minGrowthPoint=0,this.requirePoint=this.requirePointMax}return A(e,t),e.prototype.add=function(t){var e;if(t=Number(t),this.growthPoint+=t,this.growthPoint<this.minGrowthPoint&&(e=this.growthPoint-t,this.growthPoint=this.minGrowthPoint,t=this.growthPoint-e),this.requirePoint-=t,this.requirePoint<=0)for(;this.requirePoint<=0;)this.requirePoint=this.requirePoint+this.requirePointMax,this.status+=this.growthUnit;return this.requirePoint>this.requirePointMax&&(this.requirePoint=this.requirePoint-this.requirePointMax,this.status-=this.growthUnit),this.notifyUpdate()},e.prototype.setMinGrowthPoint=function(t){return this.minGrowthPoint=t},e.prototype.getMement=function(){return[this.status,this.growthPoint,this.minGrowthPoint,this.requirePoint]},e.prototype.setMement=function(t){return this.status=t[0],this.growthPoint=t[1],this.minGrowthPoint=t[2],this.requirePoint=t[3],this.notifyUpdate()},e}(h),T.AttributeStatusViewer=function(t){function e(t){e.__super__.constructor.call(this),this.jName=$("#"+t+" td:eq(0)"),this.jStatus=$("#"+t+" td:eq(1)"),this.jGrowthPoint=$("#"+t+" td:eq(2)"),this.jRequirePoint=$("#"+t+" td:eq(3)")}return A(e,t),e.prototype.onInitialize=function(t){return this.onUpdate(t)},e.prototype.onUpdate=function(t){return this.jName.text(t.name),this.jStatus.text(t.status),this.jGrowthPoint.text(t.growthPoint),this.jRequirePoint.text(t.requirePoint)},e}(a),T.AllGrowthPoint=function(t){function e(t){this.levelLimitList=t,e.__super__.constructor.call(this),this.type="Point",this.level=1,this.growthPoints={}}return A(e,t),e.prototype.getAllPoint=function(){var t,e,i,n;t=0,n=this.growthPoints;for(e in n)i=n[e],t+=i;return t},e.prototype.levelUp=function(){return this.level+=1,this.notifyUpdate()},e.prototype.isLevelUpAble=function(){return 0!==this.getLevelOfSpace()?!1:this.level>=this.levelLimitList.length?!1:!0},e.prototype.getLevelOfSpace=function(){var t;return t=this.levelLimitList[this.level-1],t-this.getAllPoint()},e.prototype.getMement=function(){return[this.growthPoints,this.level]},e.prototype.setMement=function(t){return this.growthPoints=t[0],this.level=t[1],this.notifyUpdate()},e.prototype.onInitialize=function(t){return this.onUpdate(t)},e.prototype.onUpdate=function(t){return this.growthPoints[t.attribute]=t.growthPoint,this.notifyUpdate()},e}(h),T.AllGrowthPointViewer=function(t){function e(t){this.elementId=t,e.__super__.constructor.call(this)}return A(e,t),e.prototype.onInitialize=function(t){var e,i,n,o,r;for(n=$("#"+this.elementId+" tr:eq(1) td"),i=o=0,r=n.length;r>o;i=++o)e=n[i],i<t.levelLimitList.length?$(e).text(t.levelLimitList[i]):$(e).text("-");return this.onUpdate(t)},e.prototype.onUpdate=function(t){var e,i,n,o,r,s;for(n=$("#"+this.elementId+" tr:eq(2) td"),s=[],i=o=0,r=n.length;r>o;i=++o)e=n[i],i<t.level-1?s.push($(e).text(t.levelLimitList[i])):i===t.level-1?s.push($(e).text(t.getAllPoint())):i>t.level-1?s.push($(e).text("-")):s.push(void 0);return s},e}(a),T.FoodHistory=function(t){function e(){e.__super__.constructor.call(this),this.history=[]}return A(e,t),e.prototype.push=function(t){return this.history.push(t),this.notifyUpdate()},e.prototype.pop=function(){return this.history.pop,this.notifyUpdate()},e.prototype.isUndoAble=function(){return 0===this.history.length?!1:!0},e.prototype.isUndoButtonAble=function(){return 0===this.history.length?!1:this.history[this.history.length-1]instanceof r?!1:!0},e.prototype.getMement=function(){var t,e,i,n,o;for(t=[],o=this.history,i=0,n=o.length;n>i;i++)e=o[i],t.push(e);return[t]},e.prototype.setMement=function(t){return this.history=t[0],this.notifyUpdate()},e}(h),e=function(){function t(){}return t}(),i=function(){function e(){}return e.prototype.createFromSerial=function(e,i){var n,o,s,h,a;for(s=e[i],n=[t,r,u],h=0,a=n.length;a>h;h++)if(o=n[h],o.isThisType(s))return o.createFromSerial(e,i);throw"unexpected serial"},e}(),t=function(t){function e(t){this.food=t,e.__super__.constructor.call(this),this.name=t.name}return A(e,t),e._serialBaseChars="-abcdefghijklmnopqrstuvwxyz",e.prototype.toSerial=function(){return e._serialBaseChars[this.food.id]},e.isThisType=function(t){return this._serialBaseChars.indexOf(t)>=0},e.createFromSerial=function(t,i){var n,o;return o=this._serialBaseChars.indexOf(t[i]),n=new FoodFactory,[new e(n.createById(o)),1]},e}(e),u=function(t){function e(t,i){this.level=t,this.insectType=i,e.__super__.constructor.call(this),this.name="--- Lv"+t+":"+i.shortName+" ---"}return A(e,t),e._serialBaseChars="-ABCDEFGHIJKLMNOPQRSTUVWXYZ",e.prototype.toSerial=function(){return e._serialBaseChars[this.insectType.id]},e.isThisType=function(t){return this._serialBaseChars.indexOf(t)>=0},e.createFromSerial=function(t,i){var n,o;return o=this._serialBaseChars.indexOf(t[i]),n=new InsectTypeFactory,[new e(0,n.createById(o)),1]},e}(e),r=function(t){function e(t,i,n){this.level=t,this.insectType=i,this.growthPoints=n,e.__super__.constructor.call(this),this.name="【値入力 Lv"+t+":"+i.shortName+"】"}return A(e,t),e._insectBaseChars="-ABCDEFGHIJKLMNOPQRSTUVWXYZ",e.prototype.toSerial=function(){var t,i,n,o;n="(",n+=e._insectBaseChars[this.insectType.id];for(i in ATTR)o=ATTR[i],t=this.growthPoints.filter(function(t){return t.type===o})[0],n+=null!=t?("0"+String(t.point)).slice(-2):"00";return n+=")"},e.isThisType=function(t){return"("===t},e.createFromSerial=function(t,i){var n,o,r,s,u,h,a,l,p;n=i,n+=1,s=this._insectBaseChars.indexOf(t[n]),n+=1,o=new InsectTypeFactory,u=o.createById(s),r=[];for(h in ATTR)p=ATTR[h],a=Number(t[n]+t[n+1]),n+=2,a>0&&r.push(new Attribute(p,a));return n+=1,l=n-i,[new e(0,u,r),l]},e}(e),n=function(){function t(){}return t.prototype.getSerial=function(t){var e,i,n,o,r;for(n="",o=0,r=t.length;r>o;o++)i=t[o],n+=i.toSerial();return e=new p,e.compression(n)},t.prototype.readFromSerial=function(t){var e,n,o,r,s,u,h;for(e=new p,t=e.unCompression(t),o=new i,r=[],u=0;u<t.length;)h=o.createFromSerial(t,u),n=h[0],s=h[1],r.push(n),u+=s;return r},t}(),p=function(){function t(){}return t.prototype.compression=function(t){var e,i,n,o,r,s;if(null==t||""===t)return"";for(n="",o=0,i=t[0],r=0,s=t.length;s>r;r++)e=t[r],e!==i&&(n+=this._compressionChars(i,o),o=0),o+=1,i=e;return n+=this._compressionChars(i,o)},t.prototype._compressionChars=function(t,e){return 1===e?t:2===e?t+t:t+"*"+String("0"+e.toString(16)).slice(-2)},t.prototype.unCompression=function(t){var e,i,n,o,r,s,u;for(o="",r=0;r<t.length;)if("*"===t[r]){for(e=t[r-1],n=parseInt(t[r+1]+t[r+2],16),i=s=0,u=n-1;u>=0?u>s:s>u;i=u>=0?++s:--s)o+=e;r+=3}else o+=t[r],r+=1;return o},t}(),T.FoodHistoryViewer=function(t){function e(t){this.elementId=t,e.__super__.constructor.call(this)}return A(e,t),e.prototype.onInitialize=function(){return $("#"+this.elementId+" > option").remove()},e.prototype.onUpdate=function(t){var e,i,n,o,r,s,u,h,a,p,c;for(n=$("#"+this.elementId),$("option",n).remove(),o=new l,a=t.history,r=0,u=a.length;u>r;r++)e=a[r],o.push(e.name);for(p=o.list,c=[],s=0,h=p.length;h>s;s++)i=p[s],c.push(n.append($("<option>").html(i)));return c},e}(a),l=function(){function t(){this.list=[]}return t.prototype.push=function(t){var e,i,n;return 0===this.list.length?(this.list.push(t),void 0):(e=this.list[this.list.length-1],i=e.match(new RegExp("^[^ ]+"))[0],i!==t?(this.list.push(t),void 0):(n=0,n=e.match(/\ ×\ ([0-9]+)$/)?Number(RegExp.$1)+1:2,this.list[this.list.length-1]=""+t+" × "+n))},t}(),o=function(t){function e(t){this.jText=$("#"+t),this.jText.focus(function(){return $(this).select()})}return A(e,t),e.prototype.onInitialize=function(t){return this.onUpdate(t)},e.prototype.onUpdate=function(t){var e,i,o;return o=location.protocol+"//"+location.hostname+location.pathname,i=new n,e=i.getSerial(t.history),this.jText.val(""+o+"?"+e)},e}(a),T.UndoEnableViewer=function(t){function e(t){this.elementId=t,e.__super__.constructor.call(this)}return A(e,t),e.prototype.onInitialize=function(t){return this.onUpdate(t)},e.prototype.onUpdate=function(t){var e;return e=$("#"+this.elementId),t.isUndoButtonAble()?e.removeAttr("disabled"):e.attr("disabled",!0)},e}(a),T.ResetEnableViewer=function(t){function e(t){this.elementId=t,e.__super__.constructor.call(this)}return A(e,t),e.prototype.onInitialize=function(t){return this.onUpdate(t)},e.prototype.onUpdate=function(t){var e;return e=$("#"+this.elementId),t.isUndoAble()?e.removeAttr("disabled"):e.attr("disabled",!0)},e}(a),d=function(){function t(t){this.undoAbleObjects=t,this.memory=[]}return t.prototype.getMemory=function(){var t,e,i,n,o;for(t=[],o=this.undoAbleObjects,i=0,n=o.length;n>i;i++)e=o[i],t.push(e.getMement());return t},t.prototype.setUndoPoint=function(t){return this.memory.push(t)},t.prototype.undo=function(){var t,e,i,n,o,r;if(0!==this.memory.length){for(t=this.memory.pop(),r=[],e=n=0,o=t.length;o>n;e=++n)i=t[e],r.push(this.undoAbleObjects[e].setMement(i));return r}},t.prototype.undoAll=function(){var t;for(t=[];this.memory.length>0;)t.push(this.undo());return t},t}(),c=function(){function t(){}return t.prototype.getMement=function(){},t.prototype.setMement=function(){},t}(),T.Insect=function(){function e(t,e,i,n){var o,r,s,u;this.attributeStatusList=t,this.allGrowthPoint=e,this.foodHistory=i,this.insectTypeHolder=n,s=[this.allGrowthPoint,this.foodHistory,this.insectTypeHolder],u=this.attributeStatusList;for(r in u)o=u[r],s.push(o);this.undoMemory=new d(s)}return e.prototype.eat=function(e){var i,n,o,r,s,u,h;for(r=this.undoMemory.getMemory(),o=!1,h=e.eatSotedAttributes(),s=0,u=h.length;u>s;s++)n=h[s],i=Math.min(this.allGrowthPoint.getLevelOfSpace(),n.point),this.attributeStatusList[n.type].add(i),i>0&&(o=!0);return o?(this.foodHistory.push(new t(e)),this.undoMemory.setUndoPoint(r)):void 0},e.prototype.levelUp=function(t){return this.undoMemory.setUndoPoint(this.undoMemory.getMemory()),this.attributeStatusList[ATTR.POWER].setMinGrowthPoint(t.minPowerGrowthPoint),this.attributeStatusList[ATTR.STAMINA].setMinGrowthPoint(t.minStaminaGrowthPoint),this.attributeStatusList[ATTR.SPEED].setMinGrowthPoint(t.minSpeedGrowthPoint),this.insectTypeHolder.levelUp(t),this.allGrowthPoint.levelUp(),this.foodHistory.push(new u(this.allGrowthPoint.level,t))},e.prototype.undo=function(){return this.undoMemory.undo()},e.prototype.reset=function(){return this.undoMemory.undoAll()},e.prototype.inputInit=function(t,e){var i,n,o,s,u,h,a;for(this.reset(),this.undoMemory.setUndoPoint(this.undoMemory.getMemory()),i=0,s=0,h=e.length;h>s;s++)n=e[s],this.attributeStatusList[n.type].add(n.point),i+=Number(n.point);for(this.attributeStatusList[ATTR.POWER].setMinGrowthPoint(t.minPowerGrowthPoint),this.attributeStatusList[ATTR.STAMINA].setMinGrowthPoint(t.minStaminaGrowthPoint),this.attributeStatusList[ATTR.SPEED].setMinGrowthPoint(t.minSpeedGrowthPoint),o=u=1,a=this._getLevelByPoint(i);a>=1?a>u:u>a;o=a>=1?++u:--u)this.insectTypeHolder.levelUp(t),this.allGrowthPoint.levelUp();return this.foodHistory.push(new r(this.allGrowthPoint.level,t,e))},e.prototype._getLevelByPoint=function(t){var e,i,n,o,r,s;for(i=1,e=r=0,s=LEVEL_LIMIT_LIST.length;s>r;e=++r)n=LEVEL_LIMIT_LIST[e],t>=n&&(i=e+2);return o=LEVEL_LIMIT_LIST.length,i>o&&(i=o),i},e.prototype.getHistory=function(){var t;return t=new n,t.getSerial(this.foodHistory.history)},e.prototype.setHistory=function(e){var i,o,s,h,a,l;for(s=new n,o=s.readFromSerial(e),this.reset(),l=[],h=0,a=o.length;a>h;h++)i=o[h],i instanceof t&&this.eat(i.food),i instanceof u&&this.levelUp(i.insectType),i instanceof r?l.push(this.inputInit(i.insectType,i.growthPoints)):l.push(void 0);return l},e}(),T.Attribute=function(){function t(t,e){this.type=t,this.point=e}return t}(),T.Food=function(){function t(t,e,i){var n,o,r,s;for(this.id=t,this.name=e,this.attributes=i,n=0,r=0,s=i.length;s>r;r++)o=i[r],n+=o.point;if(0!==n)throw"UnlikelyFood"}return t.prototype.eatSotedAttributes=function(){var t=this;return this.attributes.sort(function(e,i){return t.sortOrder(i)-t.sortOrder(e)})},t.prototype.sortOrder=function(t){var e,i;return e=0,t.point<0&&(e+=100),e+=Math.abs(10*t.point),((i=t.type)===ATTR.POWER||i===ATTR.STAMINA||i===ATTR.SPEED)&&(e+=1),e},t}(),T.FoodFactory=function(){function t(){this._foods=[],this._foods.push(new Food(1,"力の虫餌・火",[new Attribute(ATTR.POWER,1),new Attribute(ATTR.FIRE,1),new Attribute(ATTR.WATER,-2)])),this._foods.push(new Food(2,"力の虫餌・火炎",[new Attribute(ATTR.POWER,1),new Attribute(ATTR.FIRE,2),new Attribute(ATTR.WATER,-3)])),this._foods.push(new Food(3,"力の上虫餌",[new Attribute(ATTR.POWER,2),new Attribute(ATTR.SPEED,-1),new Attribute(ATTR.FIRE,-1)])),this._foods.push(new Food(4,"力の上虫餌・火",[new Attribute(ATTR.POWER,2),new Attribute(ATTR.FIRE,1),new Attribute(ATTR.SPEED,-3)])),this._foods.push(new Food(5,"体の虫餌・龍",[new Attribute(ATTR.STAMINA,1),new Attribute(ATTR.DRAGON,1),new Attribute(ATTR.FIRE,-2)])),this._foods.push(new Food(6,"体の虫餌・破龍",[new Attribute(ATTR.STAMINA,1),new Attribute(ATTR.DRAGON,2),new Attribute(ATTR.FIRE,-3)])),this._foods.push(new Food(7,"体の虫餌・水",[new Attribute(ATTR.STAMINA,1),new Attribute(ATTR.WATER,1),new Attribute(ATTR.THUNDER,-2)])),this._foods.push(new Food(8,"体の上虫餌",[new Attribute(ATTR.STAMINA,2),new Attribute(ATTR.POWER,-1),new Attribute(ATTR.WATER,-1)])),this._foods.push(new Food(9,"体の上虫餌・水",[new Attribute(ATTR.STAMINA,2),new Attribute(ATTR.WATER,1),new Attribute(ATTR.POWER,-3)])),this._foods.push(new Food(10,"速の虫餌・流水",[new Attribute(ATTR.SPEED,1),new Attribute(ATTR.WATER,2),new Attribute(ATTR.THUNDER,-3)])),this._foods.push(new Food(11,"速の虫餌・雷",[new Attribute(ATTR.SPEED,1),new Attribute(ATTR.THUNDER,1),new Attribute(ATTR.ICE,-2)])),this._foods.push(new Food(12,"速の虫餌・雷光",[new Attribute(ATTR.SPEED,1),new Attribute(ATTR.THUNDER,2),new Attribute(ATTR.ICE,-3)])),this._foods.push(new Food(13,"速の虫餌・氷",[new Attribute(ATTR.SPEED,1),new Attribute(ATTR.ICE,1),new Attribute(ATTR.DRAGON,-2)])),this._foods.push(new Food(14,"速の虫餌・氷結",[new Attribute(ATTR.SPEED,1),new Attribute(ATTR.ICE,2),new Attribute(ATTR.DRAGON,-3)])),this._foods.push(new Food(15,"速の上虫餌",[new Attribute(ATTR.SPEED,2),new Attribute(ATTR.STAMINA,-1),new Attribute(ATTR.THUNDER,-1)])),this._foods.push(new Food(16,"速の上虫餌・雷",[new Attribute(ATTR.SPEED,2),new Attribute(ATTR.THUNDER,1),new Attribute(ATTR.STAMINA,-3)])),this._foods.push(new Food(17,"虫餌・火炎",[new Attribute(ATTR.FIRE,2),new Attribute(ATTR.WATER,-1),new Attribute(ATTR.ICE,-1)])),this._foods.push(new Food(18,"虫餌・流水",[new Attribute(ATTR.WATER,2),new Attribute(ATTR.THUNDER,-1),new Attribute(ATTR.DRAGON,-1)])),this._foods.push(new Food(19,"虫餌・雷光",[new Attribute(ATTR.THUNDER,2),new Attribute(ATTR.SPEED,-1),new Attribute(ATTR.ICE,-1)])),this._foods.push(new Food(20,"虫餌・氷結",[new Attribute(ATTR.ICE,2),new Attribute(ATTR.STAMINA,-1),new Attribute(ATTR.DRAGON,-1)])),this._foods.push(new Food(21,"虫餌・破龍",[new Attribute(ATTR.DRAGON,2),new Attribute(ATTR.POWER,-1),new Attribute(ATTR.FIRE,-1)]))}return t.prototype.create=function(t){var e,i,n,o;for(o=this._foods,i=0,n=o.length;n>i;i++)if(e=o[i],e.name===t)return e},t.prototype.createById=function(t){var e,i,n,o;for(o=this._foods,i=0,n=o.length;n>i;i++)if(e=o[i],e.id===t)return e},t}(),T.InsectTypeHolder=function(t){function e(t){this.insectType=t,e.__super__.constructor.call(this),this.type="InsectHolder",this.level=1}return A(e,t),e.prototype.levelUp=function(t){return this.insectType=t,this.level+=1,this.notifyUpdate()},e.prototype.getNextInsectType=function(){var t,e,i,n,o;for(e=[],o=this.insectType.getChild(),i=0,n=o.length;n>i;i++)t=o[i],t.level===this.level+1&&e.push(t);return 0===e.length&&e.push(this.insectType),e},e.prototype.getMement=function(){return[this.insectType,this.level]},e.prototype.setMement=function(t){return this.insectType=t[0],this.level=t[1],this.notifyUpdate()},e}(h),s=function(){function t(t,e,i,n,o,r,s,u){this.id=t,this.name=e,this.shortName=i,this.level=n,this.minPower=o,this.minStamina=r,this.minSpeed=s,this.skill=u,this.childType=[],this.minPowerGrowthPoint=this.minPower-60,this.minStaminaGrowthPoint=this.minStamina-60,this.minSpeedGrowthPoint=this.minSpeed-60}return t.prototype.addChild=function(t){return this.childType.push(t)},t.prototype.getChild=function(){return this.childType},t.prototype.getChildByName=function(t){var e,i,n,o,r;if(t===this.shortName)return this;for(r=this.getChild(),n=0,o=r.length;o>n;n++)if(e=r[n],i=e.getChildByName(t),null!=i)return i;return null},t.prototype.getChildById=function(t){var e,i,n,o,r;if(t===this.id)return this;for(r=this.getChild(),n=0,o=r.length;o>n;n++)if(e=r[n],i=e.getChildById(t),null!=i)return i;return null},t.prototype.getAbleChilds=function(t,e){var i,n,o,r,s;for(i=[],this._checkAbleInsect(t,e)&&i.push(this),s=this.getChild(),o=0,r=s.length;r>o;o++)n=s[o],i=i.concat(n.getAbleChilds(t,e));return i},t.prototype._checkAbleInsect=function(t,e){var i;return i=this.childType.length>0?this.childType[0].level:99,this.level<=t&&i>t?e[ATTR.POWER]<this.minPowerGrowthPoint?!1:e[ATTR.STAMINA]<this.minStaminaGrowthPoint?!1:e[ATTR.SPEED]<this.minSpeedGrowthPoint?!1:!0:!1},t}(),T.NullInsectType=function(t){function e(){e.__super__.constructor.call(this,0,"","",1,999,999,999,"")}return A(e,t),e}(s),T.LevelUpButtonsTypeChanger=function(t){function e(t){this.buttons=t,e.__super__.constructor.call(this)}return A(e,t),e.prototype.onInitialize=function(t){return this.onUpdate(t)},e.prototype.onUpdate=function(t){var e,i,n,o,r,s,u,h;for(o=t.getNextInsectType(),u=this.buttons,h=[],i=r=0,s=u.length;s>r;i=++r)e=u[i],n=o[i],i<o.length?h.push(e.set("レベルアップ"+n.shortName,n)):h.push(e.set("-",new NullInsectType));return h},e}(a),T.LevelUpButton=function(t){function e(t,i){this.name=t,this.nextInsectType=i,e.__super__.constructor.call(this),this.statusPoints={},this.statusPoints[ATTR.POWER]=0,this.statusPoints[ATTR.STAMINA]=0,this.statusPoints[ATTR.SPEED]=0,this.isLevelUpAble=!1}return A(e,t),e.prototype.set=function(t,e){return this.name=t,this.nextInsectType=e,this.notifyUpdate()},e.prototype.isEnabled=function(){return this.statusPoints[ATTR.POWER]<this.nextInsectType.minPower?!1:this.statusPoints[ATTR.STAMINA]<this.nextInsectType.minStamina?!1:this.statusPoints[ATTR.SPEED]<this.nextInsectType.minSpeed?!1:this.isLevelUpAble===!1?!1:!0},e.prototype.onInitialize=function(t){return this.onUpdate(t)},e.prototype.onUpdate=function(t){return"Point"===t.type&&this.onUpdateByPoint(t),"Status"===t.type&&this.onUpdateByAttributeStatus(t),this.notifyUpdate()},e.prototype.onUpdateByPoint=function(t){return this.isLevelUpAble=t.isLevelUpAble()},e.prototype.onUpdateByAttributeStatus=function(t){return this.statusPoints[t.attribute]=t.status},e}(h),T.LevelUpButtonViewer=function(t){function e(t){this.elementId=t,e.__super__.constructor.call(this)}return A(e,t),e.prototype.onInitialize=function(t){return this.onUpdate(t)},e.prototype.onUpdate=function(t){var e;return e=$("#"+this.elementId),e.val(t.name),e.data("nextInsectType",t.nextInsectType),t.isEnabled()?e.removeAttr("disabled"):e.attr("disabled",!0)},e}(a),T.InsectEvolutionItem=function(t){function e(t){this.condInsectType=t,e.__super__.constructor.call(this),this.statusPoints={},this.statusPoints[ATTR.POWER]=0,this.statusPoints[ATTR.STAMINA]=0,this.statusPoints[ATTR.SPEED]=0,this.currentInsectType=new NullInsectType}return A(e,t),e.prototype.CheckEvolution=function(){return this.statusPoints[ATTR.POWER]<this.condInsectType.minPower?!1:this.statusPoints[ATTR.STAMINA]<this.condInsectType.minStamina?!1:this.statusPoints[ATTR.SPEED]<this.condInsectType.minSpeed?!1:!0},e.prototype.CheckCurrent=function(){return this.currentInsectType.shortName===this.condInsectType.shortName},e.prototype.onInitialize=function(t){return this.onUpdate(t)},e.prototype.onUpdate=function(t){return"InsectHolder"===t.type&&this.onUpdateByInsectHolder(t),"Status"===t.type&&this.onUpdateByAttributeStatus(t),this.notifyUpdate()},e.prototype.onUpdateByInsectHolder=function(t){return this.currentInsectType=t.insectType},e.prototype.onUpdateByAttributeStatus=function(t){return this.statusPoints[t.attribute]=t.status},e}(h),T.InsectEvolutionItemViewer=function(t){function e(t){this.elementId=t,e.__super__.constructor.call(this)}return A(e,t),e.prototype.onInitialize=function(t){return this.onUpdate(t)},e.prototype.onUpdate=function(t){var e;return e=$("#"+this.elementId),e.css("color",t.CheckEvolution()?"black":"silver"),e.css("font-weight",t.CheckCurrent()?"bold":"normal")},e}(a),T.InsectTypeFactory=function(){function t(){var t,e,i,n,o,r,u,h,a,l,p;this.root=new s(1,"マルドローン/クルドローン","(初期)",1,60,60,60,"無し"),t=new s(2,"ザミールビートル/アルマスタッグ","(攻)",4,78,60,60,"攻撃UP【小】"),e=new s(3,"ケーニヒゴアビートル/モナークブルスタッグ","(攻＋)",7,96,60,60,"攻撃UP【大】"),i=new s(4,"フィルカーノ/レジナヴァランテ","(攻回)",7,87,66,63,"攻撃UP【中】 / 回復UP【小】"),n=new s(5,"ハルキータ/ガシルドーレ","(体)",4,60,78,60,"スタミナUP【小】"),o=new s(6,"ドルンキータ/ドゥンクラーブ","(体＋)",7,60,96,60,"スタミナUP【大】"),r=new s(7,"アルジョアーニャ/ウカドゥーレ","(体回)",7,69,84,63,"スタミナUP【中】 / 回復UP【小】"),u=new s(8,"ガルーヘル/カゼキリバネ","(速)",4,60,60,78,"スピードUP【小】"),h=new s(9,"メイヴァーチル/オオシナト","(速＋)",7,60,60,96,"スピードUP【大】"),a=new s(10,"ヴァンリエール/シナトモドキ","(速回)",7,69,66,81,"スピードUP【中】 / 回復UP【小】"),l=new s(11,"エボマルドローン/エボクルドローン","(汎)",4,69,66,63,"全ステータスUP【小】"),p=new s(12,"アルジャーロン/エルドラーン","(汎＋)",7,78,72,66,"全ステータスUP【中】 / 回復UP【大】"),this.root.addChild(t),t.addChild(e),t.addChild(i),this.root.addChild(n),n.addChild(o),n.addChild(r),this.root.addChild(u),u.addChild(h),u.addChild(a),this.root.addChild(l),l.addChild(p)}return t.prototype.createRoot=function(){return this.root},t.prototype.createById=function(t){return this.root.getChildById(t)},t}(),T.InsectBuilder=function(){function t(){var t;this.attributeStatusList=null,this.allGrowthPoint=null,this.foodHistory=null,this.insectTypeHolder=null,t=new InsectTypeFactory,this.rootInsectType=t.createRoot()}return t.prototype.initAttributeStatusList=function(){return this.attributeStatusList={},this.attributeStatusList[ATTR.POWER]=new AttributeStatus("パワー",ATTR.POWER,60,9,9),this.attributeStatusList[ATTR.STAMINA]=new AttributeStatus("スタミナ",ATTR.STAMINA,60,6,6),this.attributeStatusList[ATTR.SPEED]=new AttributeStatus("スピード",ATTR.SPEED,60,3,3),this.attributeStatusList[ATTR.FIRE]=new AttributeStatus("火属性",ATTR.FIRE,0,3,2),this.attributeStatusList[ATTR.WATER]=new AttributeStatus("水属性",ATTR.WATER,0,3,2),this.attributeStatusList[ATTR.THUNDER]=new AttributeStatus("雷属性",ATTR.THUNDER,0,6,4),this.attributeStatusList[ATTR.ICE]=new AttributeStatus("氷属性",ATTR.ICE,0,6,4),this.attributeStatusList[ATTR.DRAGON]=new AttributeStatus("龍属性",ATTR.DRAGON,0,9,6),this.attributeStatusList[ATTR.POWER].addListener(new AttributeStatusViewer("trPower")),this.attributeStatusList[ATTR.STAMINA].addListener(new AttributeStatusViewer("trStamina")),this.attributeStatusList[ATTR.SPEED].addListener(new AttributeStatusViewer("trSpeed")),this.attributeStatusList[ATTR.FIRE].addListener(new AttributeStatusViewer("trFire")),this.attributeStatusList[ATTR.WATER].addListener(new AttributeStatusViewer("trWater")),this.attributeStatusList[ATTR.THUNDER].addListener(new AttributeStatusViewer("trThunder")),this.attributeStatusList[ATTR.ICE].addListener(new AttributeStatusViewer("trIce")),this.attributeStatusList[ATTR.DRAGON].addListener(new AttributeStatusViewer("trDragon"))},t.prototype.initAllGrowthPoint=function(){var t,e,i,n;this.allGrowthPoint=new AllGrowthPoint(LEVEL_LIMIT_LIST),this.allGrowthPoint.addListener(new AllGrowthPointViewer("tblAllGrowthPoint")),i=this.attributeStatusList,n=[];for(e in i)t=i[e],n.push(t.addListener(this.allGrowthPoint));return n},t.prototype.initFoodHistory=function(){return this.foodHistory=new FoodHistory,this.foodHistory.addListener(new FoodHistoryViewer("lstFoodHistory")),this.foodHistory.addListener(new UndoEnableViewer("btnUndo")),this.foodHistory.addListener(new ResetEnableViewer("btnReset")),this.foodHistory.addListener(new o("txtResultUrl"))},t.prototype.initInsectTypeHolder=function(){return this.insectTypeHolder=new InsectTypeHolder(this.rootInsectType)},t.prototype.addLevelUpButtons=function(){var t,e;return t=[],t.push(this._buildButton("btnLevelUp0")),t.push(this._buildButton("btnLevelUp1")),t.push(this._buildButton("btnLevelUp2")),t.push(this._buildButton("btnLevelUp3")),e=new LevelUpButtonsTypeChanger(t),this.insectTypeHolder.addListener(e)},t.prototype._buildButton=function(t){var e;return e=new LevelUpButton("-",new NullInsectType),e.addListener(new LevelUpButtonViewer(t)),this.allGrowthPoint.addListener(e),this.attributeStatusList[ATTR.POWER].addListener(e),this.attributeStatusList[ATTR.STAMINA].addListener(e),this.attributeStatusList[ATTR.SPEED].addListener(e),e},t.prototype.addEvolutionItems=function(){return this._buildEvolutionItem("lblEvo0"),this._buildEvolutionItem("lblEvo1"),this._buildEvolutionItem("lblEvo2"),this._buildEvolutionItem("lblEvo3"),this._buildEvolutionItem("lblEvo4"),this._buildEvolutionItem("lblEvo5"),this._buildEvolutionItem("lblEvo6"),this._buildEvolutionItem("lblEvo7"),this._buildEvolutionItem("lblEvo8"),this._buildEvolutionItem("lblEvo9"),this._buildEvolutionItem("lblEvo10"),this._buildEvolutionItem("lblEvo11")},t.prototype._buildEvolutionItem=function(t){var e,i,n;return n="("+$("#"+t).text()+")",i=this.rootInsectType.getChildByName(n),e=new InsectEvolutionItem(i),e.addListener(new InsectEvolutionItemViewer(t)),this.insectTypeHolder.addListener(e),this.attributeStatusList[ATTR.POWER].addListener(e),this.attributeStatusList[ATTR.STAMINA].addListener(e),this.attributeStatusList[ATTR.SPEED].addListener(e),e},t.prototype.getResult=function(){if(null===this.attributeStatusList)throw"not initialized attributeStatusList";if(null===this.allGrowthPoint)throw"not initialized allGrowthPoint";if(null===this.foodHistory)throw"not initialized foodHistory";if(null===this.insectTypeHolder)throw"not initialized insectTypeHolder";return new Insect(this.attributeStatusList,this.allGrowthPoint,this.foodHistory,this.insectTypeHolder)},t}(),T.InsectBuildDirector=function(){function t(t){this.builder=t}return t.prototype.construct=function(){return this.builder.initAttributeStatusList(),this.builder.initAllGrowthPoint(),this.builder.initFoodHistory(),this.builder.initInsectTypeHolder(),this.builder.addLevelUpButtons(),this.builder.addEvolutionItems(),this.builder.getResult()},t}(),T.NumberRangeValidViewer=function(t){function e(t,i,n){var o=this;this.min=i,this.max=n,e.__super__.constructor.call(this),this.jText=$(t),this.jText.change(function(){return o.onChange()}),this.jText.keyup(function(){return o.onChange()})}return A(e,t),e.prototype.isValid=function(){var t,e;return t=this.jText.val(),""===t||isNaN(t)?!1:this.min<=(e=Number(t))&&e<=this.max?!0:!1},e.prototype.onChange=function(){return this.isValid()?this.jText.css("background-color",""):this.jText.css("background-color","pink"),this.notifyUpdate()},e}(h),T.NumberSumMaxValidViewer=function(t){function e(t,i,n){var o,r,s,u,h,a=this;for(this.max=n,e.__super__.constructor.call(this),this.summary=[],this.jTexts=$(t),h=this.jTexts,o=s=0,u=h.length;u>s;o=++s)r=h[o],r.uniqueNo=o,this.summary[o]=r.value;this.jTexts.change(function(t){return a.onChange(t.target)}),this.jTexts.keyup(function(t){return a.onChange(t.target)}),this.jErrorProvider=$(i),this.onChange(this.jTexts[0])}return A(e,t),e.prototype.isValid=function(){var t,e,i,n,o;for(e=0,o=this.summary,i=0,n=o.length;n>i;i++)t=o[i],e+=Number(t);return!isNaN(e)&&this.max<e?!1:!0},e.prototype.onChange=function(t){return this.summary[t.uniqueNo]=t.value,this.isValid()?this.jErrorProvider.text(" "):this.jErrorProvider.text("※合計 "+this.max+" 以内で入力してください。"),this.notifyUpdate()},e}(h),T.RequireValidationButtonViewer=function(t){function e(t,i){var n,o,r,s;for(this.elementId=t,this.validaters=i,e.__super__.constructor.call(this),s=this.validaters,o=0,r=s.length;r>o;o++)n=s[o],n.addListener(this)}return A(e,t),e.prototype.onInitialize=function(t){return this.onUpdate(t)},e.prototype.onUpdate=function(){var t,e,i,n,o,r;for(t=!0,r=this.validaters,n=0,o=r.length;o>n;n++)i=r[n],t=t&&i.isValid();return e=$("#"+this.elementId),t?e.removeAttr("disabled"):e.attr("disabled",!0)},e}(a),T.AbleInsectTypeLister=function(t){function e(t,i){this.levelLimitList=t,this.rootInsectType=i,e.__super__.constructor.call(this),this.growthPointList={},this.growthPointList[ATTR.POWER]=0,this.growthPointList[ATTR.STAMINA]=0,this.growthPointList[ATTR.SPEED]=0,this.ableList=[this.rootInsectType]}return A(e,t),e.prototype.setGrowthPoint=function(t,e){return this.growthPointList[t]=isNaN(e)&&""!==e?0:Number(e),this.ableList=this.rootInsectType.getAbleChilds(this._getLevel(),this.growthPointList),this.notifyUpdate()},e.prototype.getAbleList=function(){return this.ableList},e.prototype._getLevel=function(){var t,e,i,n,o,r,s,u,h,a;t=0,h=this.growthPointList;for(e in h)r=h[e],t+=r;for(n=1,a=this.levelLimitList,i=s=0,u=a.length;u>s;i=++s)o=a[i],t>=o&&(n=i+2);return n},e}(h),T.AbleInsectTypeListerViewer=function(t){function e(t){e.__super__.constructor.call(this),this.jCombo=$("#"+t)}return A(e,t),e.prototype.onInitialize=function(t){return this.onUpdate(t)},e.prototype.onUpdate=function(t){var e,i,n,o,r,s;for(i=this.jCombo.val(),e=[],this.jCombo.find("option").remove(),s=t.getAbleList(),o=0,r=s.length;r>o;o++)n=s[o],e.push(n.shortName),this.jCombo.append("<option value='"+n.shortName+"'>"+n.shortName+" "+n.name+"</option>").data("insectType",n);return y.call(e,i)>=0?this.jCombo.val(i):this.jCombo.prop("selectedIndex",0)},e}(a),T.InitDialog=function(){function t(t){this.jDialog=$("#"+t)}return t.prototype.show=function(){return this.initValues(),this.jDialog.show()},t.prototype.close=function(){return this.jDialog.hide()},t.prototype.initValues=function(){var t;return t=$("div.dialogBody div.TextArea input:text"),t.val(0).change()},t}(),T.InitDialogBuilder=function(){function t(){var t;this.validators=null,t=new InsectTypeFactory,this.rootInsectType=t.createRoot()}return t.prototype.initValidaters=function(){var t=this;return this.validators=[],$("div.dialogBody div.TextArea input:text").each(function(e,i){return t.validators.push(new NumberRangeValidViewer("#"+i.id,0,90))}),this.validators.push(new NumberSumMaxValidViewer("#frmInitDialog .TextArea input:text","#lblErrorProvider",90))},t.prototype.addAbleInsectTypeLister=function(){var t,e;return t=new AbleInsectTypeLister(LEVEL_LIMIT_LIST,this.rootInsectType),t.addListener(new AbleInsectTypeListerViewer("cmbInsectType")),e=$("div.dialogBody div.TextArea input:text"),e[0].attribute=ATTR.POWER,e[1].attribute=ATTR.STAMINA,e[2].attribute=ATTR.SPEED,e[3].attribute=ATTR.FIRE,e[4].attribute=ATTR.WATER,e[5].attribute=ATTR.THUNDER,e[6].attribute=ATTR.ICE,e[7].attribute=ATTR.DRAGON,e.change(function(){return t.setGrowthPoint($(this).prop("attribute"),$(this).val())}),e.keyup(function(){return t.setGrowthPoint($(this).prop("attribute"),$(this).val())}),e.change()},t.prototype.addRequireValidationButtonViewer=function(){return new RequireValidationButtonViewer("btnInitDialogOk",this.validators)
},t.prototype.getResult=function(){return new InitDialog("initDialog")},t}(),T.InitDialogBuildDirector=function(){function t(t){this.builder=t}return t.prototype.construct=function(){return this.builder.initValidaters(),this.builder.addAbleInsectTypeLister(),this.builder.addRequireValidationButtonViewer(),this.builder.getResult()},t}()}).call(this);